<!DOCTYPE html>

<html lang="en-us">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Time from...</title>
    <link rel="stylesheet" href="css/gumby.css">
    <style>
    button{
        visibility: hidden;
    }
    </style>
</head>

<body>
    <div class="row" id="display"></div>
    <div class="row">
        <form>
            <button type="submit" onclick="go(event);"></button>
            <label for="date">Enter a date:</label>
            <div class="append field">
                <input type="date" id="date" class="wide input" placeholder="mm/dd/yyyy" />
                <div class="medium info btn">
                    <a href="" onclick="go(event);">Set it</a>
                </div>
            </div>
        </form>
        <div class="medium warning btn">
            <a href="" onclick="clearDate(event);">Clear it</a>
        </div>
    </div>
    <script>
    // Set the unit values in milliseconds.
    var msecPerYear = 31558464000; // 31558464000
    var msecPerMonth = msecPerYear / 12;
    var msecPerWeek = 604800000;
    var msecPerDay = 86400000; //24 * 60 * 60 * 1000;
    var d = document.getElementById('display');

    var b = localStorage.getItem("b");
    if (b) {
        go2(b);
    }
    // Set a date and get the milliseconds
    function go(e) {
        e.preventDefault();
        var mydate = document.getElementById('date').value;
        if(mydate){
            localStorage.setItem("b", mydate);
            go2(mydate);
        }
    }

    function go2(val) {
        var date = new Date(val);
            date = new Date(date.getTime() + date.getTimezoneOffset() * 60000); //convert to GMT-0400 (Eastern Daylight Time)
        var nowToday = new Date();

        // Get the difference in milliseconds.
        var interval = nowToday.getTime() - date.getTime();
        console.log(interval);

        // Calculate how many days the interval contains. Subtract that
        // many days from the interval to determine the remainder.
        var monthS = Math.floor(interval / msecPerMonth);
        var weekS = Math.floor(interval / msecPerWeek);
        var dayS = Math.floor(interval / msecPerDay);

        var years = Math.floor(interval / msecPerYear);
        interval = interval - (years * msecPerYear);

        var month = Math.floor(interval / msecPerMonth);
        interval = interval - (month * msecPerMonth);

        var day = Math.floor(interval / msecPerDay);

        // Display the result.
        var result = "<h1><small>Time from</small> " + date.toDateString() + " <small>is</small></h1><h2>" + years + " <small>years,</small> " + month + " <small>months,</small> " + day + " <small>days.</small></h2>";
        result += "<h5>Totals:</h5><ul><li>";
        result += monthS + " months.</li><li>";
        result += weekS + " weeks.</li><li>";
        result += dayS + " days.</li>";

        document.title = "Time from " + date.toDateString();

        d.innerHTML = '';
        d.insertAdjacentHTML("beforeend", result);
    }

    function clearDate(e){
        e.preventDefault();
        var c = localStorage.getItem("b");
        if (c) {
        localStorage.removeItem("b");
        d.innerHTML = '';
        document.title = "Time from...";
        }
    }
    </script>

</body>

</html>
